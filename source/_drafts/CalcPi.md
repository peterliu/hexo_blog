---
title: 计算圆周率
tags:
cover: /cover-image/pi-g95bae9091_640.jpg
---

本文介绍计算圆周率的方法

<!-- more -->

![](/cover-image/pi-g95bae9091_640.jpg)

## 割圆术

割圆术就是当初祖冲之计算圆周率的方法，当然不是真的把圆形切开去测量。此方法是根据勾股定理推导出的计算方法，步骤也较为简单。

割圆术的思路是用内接多边形代替圆周长，连续二分切割其中的边，进行逼近，当切割次数足够多后，内接多边形的所有边长就与圆周长很接近了，可以近似相等。

先画一个半径为1的圆形、圆形内画内接正六边形，这种状态下，圆内有6个正三角形，每个角斗士60度，每个边长度都是1，多边形周长=6，以多边形周长代替圆周长，此时圆周率 = 1*6/2 = 3

![](image/gys0.png)


### 原理推导

以半径为1的圆形、圆形内切正六边形为初始状态，这种状态下，圆内有6个正三角形，每个角斗士60度，每个边长度都是1
$$  OA = OB = OD = 1    $$
$$  AB = 1              $$

![](image/gys3.png)


以多边形边长近似约等于圆周长
$$  \pi \approx \frac{6 \times AB}{2} = 3 \times AB        $$

二分切割一条边，以 AD + BD 代替 AB
$$  \pi \approx 2 \times 3 \times BD            $$

继续二分切割，提高精度，当计算次数足够多的时候，多边形边长近似于圆周长
$$  \pi \approx 4 \times 3 \times \cdots        $$


利用勾股定理，计算 二分之后多边形每一边的 边长
$$  BD^2 = CD^2 + BC^2        \tag{1}  $$
$$  BC = \frac{AB}{2}         \tag{2}  $$
$$  CD = OD - 0C = 1 - OC     \tag{3}  $$

利用勾股定理，计算上一步中的OC
$$  OC^2 + BC^2 = OB^2  $$
$$  OC = \sqrt{(1 - (\frac{AB}{2})^2)}     \tag{4}  $$

由 (3) (4) 得出 CD
$$  CD = 1 - \sqrt{(1 - (\frac{AB}{2})^2)}     \tag{5}  $$

由 (1) (2) (5) 得出 CD，计算最终的 BD
$$  BD = \sqrt{ (1 - \sqrt{(1 - (\frac{AB}{2})^2)})^2 +  (\frac{AB}{2})^2  }  $$

将这个 BD 代入 AB ，迭代计算下去，即可得到更为精准的数值

### 示例代码


```python
import math

i = 0       # 计算步数
k = 1       # 切割次数，多边形边数/6   的倍数

def print_pi():
    print("%d  \t  |  %8d  \t  |  %1.15f" % (i, k*6, p))

print("step  \t  |  edge    \t  |  pi")
print("----  \t  |  ----    \t  |  ---")

ab = 1.0    # 多边形每一个边的长度

# Pi = 多边形边长 / 直径 = 6 * k * ab / 2 
p = k * 3.0 * ab
print_pi()

for i in range(1, 20):
    ab = math.sqrt( (1.0 - math.sqrt(1.0 - (ab/2)**2))**2 + (ab/2)**2 )
    k *= 2
    p = k * 3.0 * ab
    print_pi()
```

### 计算结果

当计算到第4步时，已经可以计算出近似值 `3.14` 了

当计算到第11步时，已经可以计算出近似值 `3.1415926` 了，与祖冲之当年的计算结果相当了

步数  |   多边形边数   |  π 
------|---------------|-------------------
0  	  |         6  	  |  3.000000000000000
1  	  |        12  	  |  3.105828541230249
2  	  |        24  	  |  3.132628613281238
3  	  |        48  	  |  3.139350203046867
4  	  |        96  	  |  3.141031950890510
5  	  |       192  	  |  3.141452472285462
6  	  |       384  	  |  3.141557607911858
7  	  |       768  	  |  3.141583892148319
8  	  |      1536  	  |  3.141590463228050
9  	  |      3072  	  |  3.141592105999272
10    |      6144  	  |  3.141592516692158
11    |     12288  	  |  3.141592619365384
12    |     24576  	  |  3.141592645033691
13    |     49152  	  |  3.141592651450768
14    |     98304  	  |  3.141592653055037
15    |    196608  	  |  3.141592653456105
16    |    393216  	  |  3.141592653556372
17    |    786432  	  |  3.141592653581438
18    |   1572864  	  |  3.141592653587705
19    |   3145728  	  |  3.141592653589271


## 级数展开法

割圆术主要的难点是开平方，计算起来比较困难，级数展开法可以

$$  \frac{1}{1+x^2} = 1 - x^2 + x^4 - x^6 + \cdots 
    = \sum_{n=0}^\infty{(-1)^n   x^{2n} }      \tag{1}  $$


11111

### 啊啊啊啊啊

sss 
